<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptic Hunt - Seats Counter</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.7/flipclock.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- jQuery loaded first -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.7/flipclock.min.js"></script> <!-- FlipClock after jQuery -->

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            color: white;
            font-family: 'Arial', sans-serif;
        }

        #logo {
            text-align: center;
            margin-bottom: 50px;
        }

        #logo img {
            width: 200px;
            height: auto;
        }

        #counter {
            text-align: center;
            font-size: 5rem;
        }
    </style>
</head>
<body>

    <div id="logo">
        <img src="ch.png" alt="Cryptic Hunt Logo">
    </div>

    <div id="counter">
        <div class="clock"></div>
    </div>

    <script>
        $(document).ready(function() {
            var totalSeats = 800; // Total seats for the event
            var clock;

            function updateClock(filledSeats) {
                if (clock) {
                    clock.stop();  // Stop the current clock
                    $('.clock').empty();  // Clear the old clock to avoid duplication
                }
                clock = $('.clock').FlipClock(filledSeats, {
                    clockFace: 'Counter',
                    autoStart: true,
                    minimumDigits: 3
                });
            }

            function fetchSeats() {
                $.get('http://localhost:3000/seats', function(data) {
                    var availableSeats = data.availableSeats;
                    var filledSeats = totalSeats - availableSeats;

                    updateClock(filledSeats);
                });
            }

            fetchSeats();
            setInterval(fetchSeats, 30000);
        });
    </script>

</body>
</html>